<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>N-Queen AI Solver â€” Deepa & Ishika </title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  :root{
    --bg-dark-1: #03040a;
    --bg-dark-2: #0b0f1c;
    --accent-1: #7c5cff;
    --accent-2: #3ac7ff;
    --muted: #98a6b3;
    --white: #f7fbff;
    --black: #0b0b0b;
    --success: #16d47a;
    --danger: #ff6b6b;
    --glass-blur: 14px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family:'Poppins', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    color:var(--white);
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    overflow-x:hidden;
    background: linear-gradient(120deg, rgba(124,92,255,0.06), rgba(58,199,255,0.02));
  }

  /* Animated gradient wave (background) */
  .animated-gradient{
    position:fixed; inset:0; z-index:0; pointer-events:none; overflow:hidden;
    background: linear-gradient(90deg, #05040a 0%, #0b0f1c 100%);
  }
  .gradient-shift{
    position:absolute; inset:-20%;
    background: radial-gradient(600px 300px at 10% 10%, rgba(124,92,255,0.18), transparent 10%),
                radial-gradient(600px 300px at 90% 90%, rgba(58,199,255,0.12), transparent 10%);
    width:140%; height:140%;
    mix-blend-mode: screen;
    filter: blur(80px) saturate(120%);
    animation: shift 22s linear infinite;
    opacity:0.55;
  }
  @keyframes shift {
    0% { transform: translate3d(-6%, -3%, 0) scale(1); }
    50% { transform: translate3d(6%, 3%, 0) scale(1.02); }
    100% { transform: translate3d(-6%, -3%, 0) scale(1); }
  }

  /* Floating orbs */
  .bg-orbs{ position:fixed; inset:0; z-index:0; pointer-events:none; overflow:hidden; }
  .orb{
    position:absolute; border-radius:50%; opacity:0.06;
    filter: blur(34px);
    transform: translate3d(0,0,0);
    animation: floatOrbs linear infinite;
  }
  .orb.a{ width:520px; height:520px; left:-10%; top:-6%; background: linear-gradient(90deg,#7c5cff,#3ac7ff); animation-duration:28s; }
  .orb.b{ width:360px; height:360px; right:-6%; bottom:-6%; background: linear-gradient(90deg,#3ac7ff,#7c5cff); animation-duration:36s; }
  @keyframes floatOrbs{
    0%{ transform: translateY(0) }
    50%{ transform: translateY(-28px) }
    100%{ transform: translateY(0) }
  }

  .container{ max-width:1180px; margin:0 auto; padding:20px; position:relative; z-index:3; }

  header{ display:flex; justify-content:space-between; align-items:center; gap:12px; margin-bottom:18px; }
  .brand{ display:flex; align-items:center; gap:12px }
  .logo{
    width:54px; height:54px; border-radius:12px;
    background: linear-gradient(135deg, rgba(124,92,255,0.14), rgba(58,199,255,0.08));
    display:flex; align-items:center; justify-content:center; font-size:22px; color:var(--white);
    box-shadow: 0 12px 40px rgba(18,12,40,0.6); border:1px solid rgba(255,255,255,0.02);
  }
  header h1{ margin:0; font-size:1.12rem; color:var(--white); font-weight:700 }
  header p.sub{ margin:0; color:var(--muted); font-size:0.82rem }

  nav{ display:flex; gap:10px; align-items:center; }
  .nav-btn{
    background: transparent; border:1px solid rgba(255,255,255,0.04); color:var(--muted);
    padding:10px 14px; border-radius:12px; cursor:pointer; font-weight:600; transition: all .16s;
    backdrop-filter: blur(var(--glass-blur));
  }
  .nav-btn:hover{ transform: translateY(-4px); color:var(--white); box-shadow: 0 12px 40px rgba(60,40,120,0.12) }
  .nav-btn.active{
    background: linear-gradient(90deg, rgba(124,92,255,0.12), rgba(58,199,255,0.06));
    color:var(--white); box-shadow: 0 12px 40px rgba(74,60,140,0.12); transform: translateY(-2px); border:1px solid rgba(124,92,255,0.18);
  }

  /* About card (3D glass) */
  .home-card{
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    padding:20px; border-radius:16px; box-shadow: 0 28px 90px rgba(3,6,20,0.72);
    border:1px solid rgba(255,255,255,0.03); margin-bottom:18px; position:relative; overflow:visible;
  }
  .about-3d { perspective:1200px; }
  .about-card {
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border-radius:14px; padding:22px; transform-origin:center;
    box-shadow: 0 36px 100px rgba(2,6,23,0.7), 0 6px 20px rgba(124,92,255,0.04);
    border:1px solid rgba(124,92,255,0.05); transition: transform .36s cubic-bezier(.2,.85,.2,1), box-shadow .36s ease, opacity .6s;
    backdrop-filter: blur(14px) saturate(120%);
    -webkit-backdrop-filter: blur(14px) saturate(120%); transform: translateY(6px); opacity:0;
  }
  .about-card.show{ transform: translateY(0); opacity:1; }
  .about-card:hover{ transform: translateY(-8px) rotateX(1deg) scale(1.01); cursor:default; }

  .about-card h2{ margin:0 0 10px 0; color:var(--accent-1); font-size:1.35rem }
  .about-card p{ margin:0; color:var(--muted); line-height:1.7; font-size:0.98rem; text-align:justify }

  .scroll-down{
    display:flex; align-items:center; justify-content:center; width:56px; height:56px; border-radius:28px;
    margin:18px auto 6px; cursor:pointer;
    background: linear-gradient(180deg, rgba(124,92,255,0.12), rgba(58,199,255,0.06));
    border:1px solid rgba(124,92,255,0.12); box-shadow: 0 12px 30px rgba(58,40,120,0.12);
    animation: floaty 2.2s ease-in-out infinite;
  }
  @keyframes floaty { 0%{ transform: translateY(0)} 50%{ transform: translateY(-8px)} 100%{ transform: translateY(0)} }
  .scroll-down svg{ filter: drop-shadow(0 6px 12px rgba(30,20,80,0.45)); }

  /* info cards */
  .info-row{ display:flex; gap:14px; margin-top:18px; flex-wrap:wrap; justify-content:center }
  .info-card{
    flex:1 1 28%; min-width:240px;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border-radius:12px; padding:16px; box-shadow: 0 18px 50px rgba(3,6,14,0.66); border:1px solid rgba(255,255,255,0.03);
    transform: translateY(22px); opacity:0; transition: transform .48s cubic-bezier(.2,.9,.2,1), opacity .48s ease;
  }
  .info-card.show{ transform: translateY(0); opacity:1; }
  .info-card h4{ margin:0 0 8px 0; color:var(--accent-2) }
  .info-card p{ margin:0; color:var(--muted); font-size:0.95rem; line-height:1.5 }

  .cta{ display:flex; gap:12px; margin-top:18px; flex-wrap:wrap; justify-content:center; }
  .primary-btn{
    background: linear-gradient(90deg,var(--accent-1), var(--accent-2));
    color:white;border:none;padding:12px 18px;border-radius:12px;cursor:pointer;font-weight:800;
    box-shadow: 0 14px 40px rgba(72,56,160,0.16); transition: transform .12s cubic-bezier(.2,.9,.2,1), box-shadow .12s;
  }
  .primary-btn:hover{ transform: translateY(-4px) scale(1.02); box-shadow: 0 20px 60px rgba(72,56,160,0.18) }

  .secondary-btn{
    background: transparent; border: 1px solid rgba(255,255,255,0.04); padding:10px 14px;
    border-radius:12px; cursor:pointer; font-weight:700; color: var(--muted);
  }

  /* play card & board */
  .card{ background: linear-gradient(180deg, rgba(12,14,24,0.7), rgba(6,8,20,0.6)); border-radius:14px;
    padding:18px; margin-top:18px; box-shadow: 0 20px 60px rgba(2,6,23,0.7); border:1px solid rgba(255,255,255,0.02); }
  .controls{ display:flex; gap:8px; align-items:center; flex-wrap:wrap; justify-content:center; margin-bottom:14px; }
  .controls label{ font-weight:600; color:var(--muted); margin-left:6px; }
  input[type=number], select{
    width:110px; padding:10px; border-radius:10px; border:1px solid rgba(255,255,255,0.03);
    text-align:center; font-weight:600; background:transparent; color:var(--white);
  }

  #boardContainer{ display:flex; flex-direction:column; align-items:center; gap:12px; margin-top:8px; position:relative; }
  #board{ display:grid; border-radius:10px; overflow:hidden; background:transparent; transition: all .25s ease; position:relative; z-index:6; }
  .cell{
    width:56px; height:56px; display:flex; align-items:center; justify-content:center; font-size:32px; user-select:none;
    cursor:pointer; transition: all .14s cubic-bezier(.2,.9,.2,1), transform .14s, box-shadow .14s; transform-origin:center;
    position:relative; overflow:visible;
  }
  .cell.appear{ animation: tileIn .32s cubic-bezier(.2,.9,.2,1) forwards; opacity:0; transform: scale(.9) }
  @keyframes tileIn { to { opacity:1; transform: scale(1)} }
  .cell:hover{ transform: translateY(-6px) scale(1.02); box-shadow: 0 18px 38px rgba(0,0,0,0.6) }

  /* black and white tiles that pop */
  .white{ background: linear-gradient(180deg,#ffffff,#f1f5ff); color:var(--black);
    box-shadow: inset 0 -6px 14px rgba(0,0,0,0.03), 0 6px 20px rgba(70,60,120,0.03); }
  .black{ background: linear-gradient(180deg,#0b0b0b,#151521); color:var(--white);
    box-shadow: 0 8px 30px rgba(0,0,0,0.7); }
  .queen{
    color:#ffdd57; text-shadow:0 6px 20px rgba(255,170,70,0.12); font-size:28px;
    display:inline-block; transform-origin:center; will-change:transform;
  }
  .queen.pulse{ animation: queenPulse 480ms cubic-bezier(.2,.9,.2,1); }
  @keyframes queenPulse { 0%{ transform: scale(.9) } 50%{ transform: scale(1.14) } 100%{ transform: scale(1) } }

  .cell.glow{ box-shadow: 0 18px 36px rgba(58,199,255,0.12), 0 2px 10px rgba(124,92,255,0.06); transform: translateY(-6px) scale(1.03); }

  .invalid{ background: rgba(255,80,80,0.14) !important; color: #ffb4b4 !important; }

  #rippleLayer{ position:absolute; pointer-events:none; z-index:7; top:0; left:50%; transform: translateX(-50%); }
  #confettiCanvas{ position:fixed; inset:0; pointer-events:none; z-index:1200; display:none; }

  .modal{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(2,6,23,0.8); z-index:999; }
  .modal .modal-body{ width:92%; max-width:900px; background:linear-gradient(180deg,#0e1220,#07070b); padding:12px; border-radius:10px; box-shadow:0 30px 80px rgba(2,6,23,0.9); border:1px solid rgba(124,92,255,0.06) }

  footer{ margin-top:18px; color:var(--muted); font-size:0.95rem; text-align:center; padding-bottom:36px }

  @media(max-width:880px){
    .info-row{ flex-direction:column; }
    .cell{ width:44px; height:44px; font-size:26px }
    header{ flex-direction:column; align-items:flex-start; gap:8px }
  }

  .page{ opacity:0; transform: translateY(8px); transition: opacity .32s ease, transform .32s ease; }
  .page.show{ opacity:1; transform: translateY(0); }

</style>
</head>
<body>
  <!-- animated gradient + orbs -->
  <div class="animated-gradient" aria-hidden="true">
    <div class="gradient-shift"></div>
  </div>
  <div class="bg-orbs" aria-hidden="true">
    <div class="orb a"></div>
    <div class="orb b"></div>
  </div>

  <div class="container">
    <header>
      <div class="brand">
        <div class="logo">â™›</div>
        <div>
          <h1>N-Queen AI Solver</h1>
          <p class="sub">Deepa & Ishika â€” AI & Data Science (YCCE)</p>
        </div>
      </div>

      <nav>
        <button id="navHome" class="nav-btn active" onclick="show('home')">Home</button>
        <button id="navPlay" class="nav-btn" onclick="show('play')">Play</button>
        <button id="navLearn" class="nav-btn" onclick="show('learn')">Learn</button>
      </nav>
    </header>

    <!-- HOME -->
    <section id="home" class="page show">
      <div class="home-card about-3d">
        <div id="aboutCard" class="about-card" role="region" aria-label="About this project">
          <h2>About this Project</h2>
          <p>
            This project is a part of our journey in exploring the fascinating world of Artificial Intelligence. It demonstrates the implementation of intelligent problem-solving techniques through the N-Queens Puzzle, a classic AI problem. The system incorporates multiple AI algorithms such as Backtracking, Hill Climbing, and Genetic Algorithm to find valid solutions for placing N queens on a chessboard so that no two queens attack each other.
            <br><br>
            This project has been designed and developed by Deepa and Ishika, students of the 5th semester, Artificial Intelligence and Data Science (AIDS) branch at Yeshwantrao Chavan College of Engineering, Nagpur (YCCE).
            <br><br>
            The objective of this project is not only to provide a hands-on experience in AI algorithm implementation but also to encourage intuitive understanding through interactive visualization and educational content.
          </p>
        </div>

        <div class="scroll-down" title="Scroll to info" onclick="revealInfo()">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M12 5v14M5 12l7 7 7-7" stroke="white" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>

        <div id="infoSection" style="margin-top:8px; opacity:0; transform: translateY(8px); transition: all .5s ease;">
          <div class="info-row">
            <div class="info-card" id="card1">
              <h4>What is N-Queen?</h4>
              <p>The N-Queens problem asks how to place N chess queens on an NÃ—N board so that none can attack another â€” i.e., no two share a row, column, or diagonal.</p>
            </div>

            <div class="info-card" id="card2">
              <h4>Its Importance</h4>
              <p>N-Queens is a classic constraint-satisfaction and combinatorial optimization problem used in teaching search algorithms, heuristics, and metaheuristics in AI courses.</p>
            </div>

            <div class="info-card" id="card3">
              <h4>Applications in AI</h4>
              <p>The N-Queens problem helps teach algorithm design, constraint solving, optimization techniques, and provides a practical case to compare exact and heuristic methods used widely in AI and operations research.</p>
            </div>
          </div>
        </div>

        <div class="cta" style="margin-top:18px">
          <button class="primary-btn" onclick="show('play')">â–¶ Play N-Queen</button>
          <button class="secondary-btn" onclick="show('learn')">ðŸ§  Learn Algorithms</button>
        </div>
      </div>
    </section>

    <!-- PLAY -->
    <section id="play" class="page" style="display:none; position:relative">
      <div class="card" style="display:flex;flex-direction:column;align-items:center; position:relative">
        <div class="controls">
          <label>Board size (N):</label>
          <input id="nInput" type="number" min="1" max="20" value="8" />
          <button class="secondary-btn" onclick="loadBoard()">Load Board</button>

          <label style="margin-left:6px">Algorithm:</label>
          <select id="algoSelect">
            <option value="backtracking">Backtracking</option>
            <option value="hillclimbing">Hill Climbing</option>
            <option value="genetic">Genetic</option>
          </select>

          <button class="primary-btn" onclick="autoSolve()">Solve</button>
          <button class="secondary-btn" onclick="resetBoard()">Reset</button>
        </div>

        <div id="boardContainer" style="position:relative;">
          <div id="rippleLayer"></div>
          <div id="board"></div>
          <div id="resultMessage"></div>
        </div>
      </div>
    </section>

    <!-- LEARN -->
    <section id="learn" class="page" style="display:none">
      <div class="card">
        <h3 style="color:var(--accent-2); margin:0 0 8px 0">Learn â€” curated lectures</h3>
        <p style="color:var(--muted); margin:0 0 12px 0">Click "Watch Video" to open an embedded player.</p>

        <div class="learn-grid">
          <div class="video-card">
            <h4>Backtracking â€” N-Queens (lecture)</h4>
            <p>Classic backtracking approach explanation.</p>
            <div style="display:flex;gap:8px;align-items:center">
              <button class="secondary-btn" onclick="openVideo('backtracking')">â–¶ Watch Video</button>
              <a href="https://www.youtube.com/watch?v=xFv_Hl4B83A" target="_blank" style="color:var(--accent-2); margin-left:8px">YouTube</a>
            </div>
          </div>

          <div class="video-card">
            <h4>Hill Climbing / Local Search</h4>
            <p>Local search and hill-climbing strategies for N-Queens.</p>
            <div style="display:flex;gap:8px;align-items:center">
              <button class="secondary-btn" onclick="openVideo('hill')">â–¶ Watch Video</button>
              <a href="https://www.youtube.com/watch?v=tCaYz8fmlpE" target="_blank" style="color:var(--accent-2); margin-left:8px">YouTube</a>
            </div>
          </div>

          <div class="video-card">
            <h4>Genetic Algorithms</h4>
            <p>Population-based optimization and GA concepts.</p>
            <div style="display:flex;gap:8px;align-items:center">
              <button class="secondary-btn" onclick="openVideo('genetic')">â–¶ Watch Video</button>
              <a href="https://www.youtube.com/watch?v=tTFBz6tbUfU" target="_blank" style="color:var(--accent-2); margin-left:8px">YouTube</a>
            </div>
          </div>
        </div>
      </div>
    </section>

    <footer>Â© 2025 â€” N-Queen AI Project</footer>
  </div>

  <!-- modal & confetti canvas -->
  <div id="videoModal" class="modal" onclick="closeVideo()">
    <div class="modal-body" onclick="event.stopPropagation()">
      <div style="display:flex;justify-content:flex-end"><button class="nav-btn" onclick="closeVideo()">Close</button></div>
      <div id="videoHolder" style="margin-top:8px"></div>
    </div>
  </div>
  <canvas id="confettiCanvas"></canvas>

<script>
/* ---------------- NAV + PAGES ---------------- */
function show(id){
  document.querySelectorAll('.page').forEach(p=>{
    p.classList.remove('show');
    p.style.display = 'none';
  });
  const el = document.getElementById(id);
  el.style.display = 'block';
  requestAnimationFrame(()=> setTimeout(()=> el.classList.add('show'), 12) );

  document.querySelectorAll('nav .nav-btn').forEach(b=>b.classList.remove('active'));
  if(id==='home') document.getElementById('navHome').classList.add('active');
  if(id==='play') document.getElementById('navPlay').classList.add('active');
  if(id==='learn') document.getElementById('navLearn').classList.add('active');

  if(id==='play') loadBoard();
  window.scrollTo({top:0, behavior:'smooth'});
}

/* ---------------- AUDIO (click + success) ---------------- */
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
function playClick(){
  if(audioCtx.state === 'suspended') audioCtx.resume();
  const o = audioCtx.createOscillator();
  const g = audioCtx.createGain();
  o.type='sine'; o.frequency.setValueAtTime(700, audioCtx.currentTime);
  g.gain.setValueAtTime(0.0001, audioCtx.currentTime);
  g.gain.exponentialRampToValueAtTime(0.05, audioCtx.currentTime+0.01);
  g.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime+0.18);
  o.connect(g); g.connect(audioCtx.destination);
  o.start(); o.stop(audioCtx.currentTime+0.2);
}
function playSuccess(){
  if(audioCtx.state === 'suspended') audioCtx.resume();
  const now = audioCtx.currentTime;
  const g = audioCtx.createGain(); g.connect(audioCtx.destination);
  g.gain.setValueAtTime(0.0001, now);
  g.gain.linearRampToValueAtTime(0.08, now+0.02);
  g.gain.exponentialRampToValueAtTime(0.0001, now+1.1);
  const osc1 = audioCtx.createOscillator(); osc1.type='triangle'; osc1.frequency.setValueAtTime(440, now);
  const osc2 = audioCtx.createOscillator(); osc2.type='sine'; osc2.frequency.setValueAtTime(660, now);
  osc1.connect(g); osc2.connect(g);
  osc1.start(now); osc2.start(now+0.02);
  osc1.frequency.exponentialRampToValueAtTime(880, now+0.35);
  osc2.frequency.exponentialRampToValueAtTime(990, now+0.45);
  osc1.stop(now+1.05); osc2.stop(now+1.05);
}

/* ---------------- floating tiny particles (subtle) ---------------- */
(function createParticles(){
  const container = document.createElement('div');
  container.style.position='fixed'; container.style.zIndex=1; container.style.inset=0; container.style.pointerEvents='none';
  document.body.appendChild(container);
  const count = 22;
  for(let i=0;i<count;i++){
    const p = document.createElement('div');
    p.style.position='absolute';
    const size = Math.random()*6 + 4;
    p.style.width = p.style.height = size + 'px';
    p.style.borderRadius='50%';
    p.style.background = `linear-gradient(90deg, rgba(124,92,255,0.9), rgba(58,199,255,0.9))`;
    p.style.opacity = 0.04 + Math.random()*0.08;
    p.style.left = Math.random()*100 + '%';
    p.style.top = Math.random()*100 + '%';
    p.style.filter = 'blur(6px)';
    p.style.transform = 'translate3d(0,0,0)';
    const dur = 20 + Math.random()*30;
    p.animate([{ transform: 'translateY(0px)' }, { transform: `translateY(${(Math.random()*80-40)|0}px)` }, { transform: 'translateY(0px)' }], { duration: dur*1000, iterations: Infinity, direction:'alternate', easing:'ease-in-out', delay: Math.random()*2000 });
    container.appendChild(p);
  }
})();

/* ---------------- confetti (celebration) ---------------- */
const confetti = (function(){
  const canvas = document.getElementById('confettiCanvas');
  const ctx = canvas.getContext('2d');
  let W=0,H=0, particles=[], rafId=null;
  function resize(){ W=canvas.width = innerWidth; H=canvas.height = innerHeight; }
  function rand(min,max){ return Math.random()*(max-min)+min; }
  function spawn(n=100){
    particles = [];
    for(let i=0;i<n;i++){
      particles.push({
        x: rand(0,W),
        y: rand(-H*0.2,0),
        vx: rand(-3,3),
        vy: rand(2,7),
        size: Math.floor(rand(6,14)),
        color: `hsl(${Math.floor(rand(210,300))}deg, 75%, ${Math.floor(rand(45,65))}%)`,
        rot: rand(0,Math.PI*2),
        drot: rand(-0.12,0.12),
        lifetime: rand(2200,4200),
        born: performance.now()
      });
    }
    resize(); canvas.style.display='block'; loop();
  }
  function loop(now){
    ctx.clearRect(0,0,W,H);
    const t = now || performance.now();
    particles.forEach(p=>{
      p.x += p.vx; p.y += p.vy; p.rot += p.drot;
      ctx.save();
      ctx.translate(p.x,p.y);
      ctx.rotate(p.rot);
      ctx.fillStyle = p.color;
      ctx.fillRect(-p.size/2, -p.size/2, p.size, p.size*0.7);
      ctx.restore();
    });
    particles = particles.filter(p => (t - p.born) < p.lifetime && p.y < H+50);
    if(particles.length>0) rafId = requestAnimationFrame(loop);
    else { canvas.style.display='none'; cancelAnimationFrame(rafId); }
  }
  window.addEventListener('resize', resize);
  return { burst: spawn };
})();

/* ---------------- BOARD logic (fixed single-queen rendering) ---------------- */
let N=8, board=[], userPlaced=[];
const boardEl = ()=>document.getElementById('board');
const msgEl = ()=>document.getElementById('resultMessage');

/* create board cells & animate tiles in */
function loadBoard(){
  const input = parseInt(document.getElementById('nInput').value) || 8;
  if(input===2 || input===3){
    showMessageFail('âŒ N = 2 and N = 3 are not allowed (no solution exists)');
    return;
  }
  N = input;
  const b = boardEl();
  b.innerHTML = '';
  const maxWidth = Math.min(560, window.innerWidth - 120);
  const cellSize = Math.max(36, Math.min(64, Math.floor(maxWidth / N) ));
  b.style.gridTemplateColumns = `repeat(${N}, ${cellSize}px)`;
  b.style.gap = '0px';
  board = Array.from({length:N}, ()=>Array(N).fill(0));
  userPlaced = Array.from({length:N}, ()=>Array(N).fill(false));
  for(let r=0;r<N;r++){
    for(let c=0;c<N;c++){
      const cell = document.createElement('div');
      cell.className = 'cell ' + (((r+c)%2===0)?'white':'black');
      cell.dataset.r = r; cell.dataset.c = c;
      cell.style.opacity = 0;
      cell.addEventListener('click', onCellClick);
      b.appendChild(cell);
    }
  }
  // tile entrance stagger
  const children = Array.from(b.children);
  children.forEach((cell,i)=>{
    setTimeout(()=>{ cell.classList.add('appear'); cell.style.opacity=1 }, i*16);
  });
  hideMessage();
}

/* place/remove queen on click */
function onCellClick(e){
  if(audioCtx.state === 'suspended') audioCtx.resume();
  playClick();
  const r = parseInt(e.currentTarget.dataset.r);
  const c = parseInt(e.currentTarget.dataset.c);
  if(board[r][c]===1){
    board[r][c]=0; userPlaced[r][c]=false;
    animateCellRemove(e.currentTarget);
  } else {
    // if trying to place in same column or row or diagonal? we still allow user to place, but conflicts will be highlighted
    board[r][c]=1; userPlaced[r][c]=true;
    animateCellPlace(e.currentTarget);
  }
  refreshUI();
  e.currentTarget.classList.add('glow');
  setTimeout(()=> e.currentTarget.classList.remove('glow'), 520);
  checkUserSolved();
}

/* visual place animation */
function animateCellPlace(cell){
  // remove any existing queen element to avoid duplication (defensive)
  cell.querySelectorAll('.queen').forEach(k=>k.remove());
  // falling + bounce effect via web animations
  cell.animate([
    { transform: 'translateY(-40px) scale(0.7)', opacity:0 },
    { transform: 'translateY(8px) scale(1.06)', opacity:1, offset:0.75 },
    { transform: 'translateY(0) scale(1)', opacity:1 }
  ], { duration:420, easing:'cubic-bezier(.2,.85,.2,1)' });
}

/* visual remove animation */
function animateCellRemove(cell){
  // subtle shrink out
  cell.animate([
    { transform: 'scale(1)', opacity:1 },
    { transform: 'scale(0.86)', opacity:0.12 }
  ], { duration:260, easing:'ease-in' });
}

/* refresh UI and ensure only one queen element per cell */
function refreshUI(){
  const cells = boardEl().children;
  for(let r=0;r<N;r++){
    for(let c=0;c<N;c++){
      const idx = r*N + c;
      const cell = cells[idx];
      // clear previous queen elements & text
      cell.innerHTML = '';
      if(board[r][c]===1){
        // create a single queen element
        const span = document.createElement('div');
        span.className = 'queen';
        span.textContent = 'â™›';
        cell.appendChild(span);
        // add pulse briefly
        span.classList.add('pulse');
        setTimeout(()=> span.classList.remove('pulse'), 520);
      }
      cell.classList.remove('invalid');
    }
  }
  // mark conflicts for user-placed ones
  for(let r=0;r<N;r++){
    for(let c=0;c<N;c++){
      if(userPlaced[r][c] && board[r][c]===1 && isConflicting(r,c)){
        boardEl().children[r*N+c].classList.add('invalid');
      }
    }
  }
}

/* conflict detection */
function isConflicting(r,c){
  for(let i=0;i<N;i++){
    if(i!==c && board[r][i]===1) return true;
    if(i!==r && board[i][c]===1) return true;
  }
  for(let d=-N; d<=N; d++){
    if(d===0) continue;
    let rr=r+d, cc=c+d;
    if(rr>=0 && rr<N && cc>=0 && cc<N && board[rr][cc]===1) return true;
    rr=r+d; cc=c-d;
    if(rr>=0 && rr<N && cc>=0 && cc<N && board[rr][cc]===1) return true;
  }
  return false;
}

/* check solved => ripple + confetti + glow */
function checkUserSolved(){
  let count=0, conflict=false;
  for(let r=0;r<N;r++) for(let c=0;c<N;c++){
    if(board[r][c]===1 && userPlaced[r][c]) { count++; if(isConflicting(r,c)) conflict=true; }
  }
  if(count===N && !conflict){
    showMessageSuccess('ðŸŽ‰ Congrats! You solved it!');
    playSuccess();
    triggerBoardRipple();
    confetti.burst(100);
    flashBackgroundGlow();
  } else {
    const m = msgEl();
    if(!m.textContent.includes('not allowed')) hideMessage();
  }
}

/* messages */
function hideMessage(){ const m=msgEl(); m.style.display='none'; m.textContent=''; m.style.color=''; }
function showMessageSuccess(t){ const m=msgEl(); m.style.display='block'; m.textContent=t; m.style.color='var(--success)'; }
function showMessageFail(t){ const m=msgEl(); m.style.display='block'; m.textContent=t; m.style.color='var(--danger)'; }

/* reset */
function resetBoard(){ loadBoard(); }

/* solver dispatcher */
async function autoSolve(){
  hideMessage();
  const algo = document.getElementById('algoSelect').value;
  const input = parseInt(document.getElementById('nInput').value) || N;
  if(input===2 || input===3){ showMessageFail('âŒ N = 2 and N = 3 are not allowed'); return; }
  if(input !== N) loadBoard();
  for(let r=0;r<N;r++) for(let c=0;c<N;c++) if(userPlaced[r][c]) if(isConflictingWithUser(r,c)){ showMessageFail('âŒ Conflicting fixed queens â€” solver aborted'); return; }

  if(algo==='backtracking') return backtrackingSolve();
  if(algo==='hillclimbing') return hillClimbSolve();
  if(algo==='genetic') return geneticSolve();
}

/* -------- Backtracking (animated) -------- */
async function backtrackingSolve(){
  const work = Array.from({length:N}, ()=>Array(N).fill(0));
  for(let r=0;r<N;r++) for(let c=0;c<N;c++) if(userPlaced[r][c]) work[r][c]=1;

  function safe(row,col){
    for(let i=0;i<N;i++) if(work[row][i]===1 && i!==col) return false;
    for(let i=0;i<N;i++) if(work[i][col]===1 && i!==row) return false;
    for(let d=-N; d<=N; d++){
      if(d===0) continue;
      let rr=row+d, cc=col+d;
      if(rr>=0&&rr<N&&cc>=0&&cc<N && work[rr][cc]===1) return false;
      rr=row+d; cc=col-d;
      if(rr>=0&&rr<N&&cc>=0&&cc<N && work[rr][cc]===1) return false;
    }
    return true;
  }

  async function placeRow(row){
    if(row===N){
      for(let r=0;r<N;r++) for(let c=0;c<N;c++) board[r][c]=work[r][c];
      refreshUI(); return true;
    }
    for(let c=0;c<N;c++) if(userPlaced[row][c]) { if(!safe(row,c)) return false; if(await placeRow(row+1)) return true; return false; }
    for(let col=0; col<N; col++){
      if(safe(row,col)){
        work[row][col]=1; applyWork(work); await sleep(55);
        if(await placeRow(row+1)) return true;
        work[row][col]=0; applyWork(work); await sleep(22);
      }
    }
    return false;
  }

  const solved = await placeRow(0);
  if(solved){ showMessageSuccess('âœ… Solution Found using Backtracking!'); playSuccess(); confetti.burst(90); triggerBoardRipple(); flashBackgroundGlow(); }
  else showMessageFail('âŒ Solution Not Found â€” Algorithm insufficient!');
}

/* helper: check conflicting fixed queens */
function isConflictingWithUser(r,c){
  for(let i=0;i<N;i++){
    if(i!==c && userPlaced[r][i] && board[r][i]===1) return true;
    if(i!==r && userPlaced[i][c] && board[i][c]===1) return true;
  }
  for(let d=-N; d<=N; d++){
    if(d===0) continue;
    let rr = r + d, cc = c + d;
    if(rr>=0&&rr<N&&cc>=0&&cc<N && userPlaced[rr][cc] && board[rr][cc]===1) return true;
    rr = r + d; cc = c - d;
    if(rr>=0&&rr<N&&cc>=0&&cc<N && userPlaced[rr][cc] && board[rr][cc]===1) return true;
  }
  return false;
}

/* apply work to main board */
function applyWork(work){
  for(let r=0;r<N;r++) for(let c=0;c<N;c++) board[r][c]=work[r][c];
  refreshUI();
}

/* -------- Hill Climbing (animated) -------- */
async function hillClimbSolve(){
  function buildInitial(){
    const q = new Array(N);
    for(let col=0; col<N; col++){
      let fixedRow=-1;
      for(let r=0;r<N;r++) if(userPlaced[r][col]) fixedRow=r;
      q[col] = (fixedRow>=0? fixedRow : Math.floor(Math.random()*N));
    }
    return q;
  }
  function conflicts(q){
    let cnt=0;
    for(let i=0;i<N;i++) for(let j=i+1;j<N;j++){
      if(q[i]===q[j] || Math.abs(q[i]-q[j])===Math.abs(i-j)) cnt++;
    }
    return cnt;
  }

  let q = buildInitial();
  let c = conflicts(q);
  for(let iter=0; iter<2000 && c>0; iter++){
    let improved=false;
    for(let col=0; col<N; col++){
      let fixed=false; for(let r=0;r<N;r++) if(userPlaced[r][col]) fixed=true;
      if(fixed) continue;
      let bestRow=q[col], bestC=c;
      for(let row=0; row<N; row++){
        let tmp=q.slice(); tmp[col]=row;
        let newC=conflicts(tmp);
        if(newC<bestC){ bestC=newC; bestRow=row; }
      }
      if(bestRow!==q[col]){ q[col]=bestRow; c=bestC; improved=true; }
    }
    applyQueens(q); await sleep(55);
    if(!improved){
      for(let col=0; col<N; col++){
        let fixed=false; for(let r=0;r<N;r++) if(userPlaced[r][col]) fixed=true;
        if(!fixed) q[col] = Math.floor(Math.random()*N);
      }
      c = conflicts(q);
    }
  }

  if(c===0){ showMessageSuccess('âœ… Solution Found using Hill Climbing!'); playSuccess(); confetti.burst(90); triggerBoardRipple(); flashBackgroundGlow(); return true; }
  else { showMessageFail('âŒ Hill Climbing could not find a solution'); return false; }
}

/* -------- Genetic Algorithm (animated) -------- */
async function geneticSolve(){
  function fitness(q){
    let count=0;
    for(let i=0;i<N;i++) for(let j=i+1;j<N;j++){
      if(q[i]!==q[j] && Math.abs(q[i]-q[j])!==Math.abs(i-j)) count++;
    }
    return count;
  }
  function randomQ(){
    const q = new Array(N);
    for(let i=0;i<N;i++){
      let fixedRow=-1;
      for(let r=0;r<N;r++) if(userPlaced[r][i]) fixedRow=r;
      q[i] = (fixedRow>=0 ? fixedRow : Math.floor(Math.random()*N));
    }
    return q;
  }

  let population = Array.from({length:60}, ()=>randomQ());
  const target = N*(N-1)/2;
  for(let gen=0; gen<1000; gen++){
    population.sort((a,b)=>fitness(b)-fitness(a));
    const best = population[0];
    applyQueens(best); await sleep(45);
    if(fitness(best)===target){ showMessageSuccess('âœ… Genetic Algorithm Solved!'); playSuccess(); confetti.burst(100); triggerBoardRipple(); flashBackgroundGlow(); return true; }

    const parents = population.slice(0,20);
    const newPop = [];
    while(newPop.length < population.length){
      const p1 = parents[Math.floor(Math.random()*parents.length)];
      const p2 = parents[Math.floor(Math.random()*parents.length)];
      const cross = Math.floor(Math.random()*N);
      const child = p1.slice(0,cross).concat(p2.slice(cross));
      if(Math.random()<0.12){
        let col = Math.floor(Math.random()*N);
        let fixed=false; for(let r=0;r<N;r++) if(userPlaced[r][col]) fixed=true;
        if(!fixed) child[col] = Math.floor(Math.random()*N);
      }
      for(let col=0; col<N; col++){
        for(let row=0; row<N; row++) if(userPlaced[row][col]) child[col]=row;
      }
      newPop.push(child);
    }
    population = newPop;
  }
  showMessageFail('âŒ Genetic Algorithm could not find a solution');
  return false;
}

/* apply q array to board */
function applyQueens(q){
  board = Array.from({length:N}, ()=>Array(N).fill(0));
  for(let c=0;c<N;c++) board[q[c]][c]=1;
  refreshUI();
}

/* helpers */
function sleep(ms){ return new Promise(res=>setTimeout(res,ms)); }

/* ripple + background flash */
function triggerBoardRipple(){
  const board = document.getElementById('board');
  const rippleLayer = document.getElementById('rippleLayer');
  rippleLayer.innerHTML = '';
  const rect = board.getBoundingClientRect();
  rippleLayer.style.width = rect.width + 'px';
  rippleLayer.style.left = (rect.left + rect.width/2) + 'px';
  rippleLayer.style.top = (rect.top + window.scrollY + 10) + 'px';
  rippleLayer.style.height = rect.height + 'px';
  const ripple = document.createElement('div');
  ripple.style.position='absolute'; ripple.style.left='50%'; ripple.style.top='50%';
  ripple.style.width='8px'; ripple.style.height='8px'; ripple.style.borderRadius='50%';
  ripple.style.background='radial-gradient(circle, rgba(58,199,255,0.6), rgba(124,92,255,0.4))';
  ripple.style.transform='translate(-50%,-50%)';
  ripple.style.opacity='0.9';
  ripple.style.boxShadow='0 0 80px rgba(58,199,255,0.18)';
  rippleLayer.appendChild(ripple);
  ripple.animate([
    { transform:'translate(-50%,-50%) scale(0.6)', opacity:1 },
    { transform:'translate(-50%,-50%) scale(12)', opacity:0.02 }
  ], { duration:900, easing:'cubic-bezier(.2,.9,.2,1)'});
  setTimeout(()=> ripple.remove(), 980);
}

function flashBackgroundGlow(){
  const g = document.querySelector('.gradient-shift');
  if(!g) return;
  g.animate([{ opacity:0.45 }, { opacity:0.9 }, { opacity:0.45 }], { duration:900, easing:'ease-out' });
}

/* reveal about & info cards */
function revealInfo(){
  const about = document.getElementById('aboutCard');
  about.classList.add('show');
  const sec = document.getElementById('infoSection');
  sec.style.opacity = 1; sec.style.transform = 'translateY(0)';
  setTimeout(()=> document.getElementById('card1').classList.add('show'), 120);
  setTimeout(()=> document.getElementById('card2').classList.add('show'), 300);
  setTimeout(()=> document.getElementById('card3').classList.add('show'), 520);
  sec.scrollIntoView({behavior:'smooth', block:'center'});
}

/* video modal */
const videos = {
  backtracking: "https://www.youtube.com/embed/xFv_Hl4B83A",
  hill: "https://www.youtube.com/embed/tCaYz8fmlpE",
  genetic: "https://www.youtube.com/embed/tTFBz6tbUfU"
};
function openVideo(key){
  const modal = document.getElementById('videoModal');
  const holder = document.getElementById('videoHolder');
  holder.innerHTML = `<iframe width="100%" height="480" src="${videos[key]}?rel=0" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>`;
  modal.style.display='flex';
}
function closeVideo(){
  const modal = document.getElementById('videoModal');
  const holder = document.getElementById('videoHolder');
  holder.innerHTML='';
  modal.style.display='none';
}

/* init */
window.addEventListener('load', ()=>{
  setTimeout(()=> document.getElementById('aboutCard').classList.add('show'), 220);
  document.getElementById('navHome').classList.add('active');
  loadBoard();
});
</script>
</body>
</html>
