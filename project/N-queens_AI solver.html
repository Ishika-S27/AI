<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>N-Queen AI Solver â€” Deepa & Ishika</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  :root{
    --bg-dark-1: #05060a;
    --bg-dark-2: #0b1020;
    --glass: rgba(255,255,255,0.04);
    --glass-2: rgba(255,255,255,0.03);
    --accent-1: #7c5cff;   /* violet */
    --accent-2: #3ac7ff;   /* cyan */
    --muted: #9aa5b1;
    --success: #16d47a;
    --danger: #ff6b6b;
    --white: #f8fbff;
    --black: #0b0b0b;
    --card-blur: 12px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family:'Poppins', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background:
      radial-gradient(800px 400px at 10% 10%, rgba(58,199,255,0.03), transparent 6%),
      linear-gradient(180deg,var(--bg-dark-1), var(--bg-dark-2));
    color:var(--white);
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    padding:28px 18px;
  }

  .container{
    max-width:1180px;
    margin:0 auto;
    padding:10px;
  }

  header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:12px;
    margin-bottom:22px;
  }
  .brand{ display:flex; align-items:center; gap:12px }
  .logo{
    width:54px; height:54px; border-radius:12px;
    background: linear-gradient(135deg, rgba(124,92,255,0.12), rgba(58,199,255,0.06));
    display:flex; align-items:center; justify-content:center; font-size:22px;
    color:var(--white); box-shadow: 0 8px 30px rgba(59,50,110,0.28);
    border:1px solid rgba(255,255,255,0.03);
  }
  header h1{ margin:0; font-size:1.1rem; color:var(--white); font-weight:700 }
  header p.sub{ margin:0; color:var(--muted); font-size:0.82rem }

  nav{ display:flex; gap:10px; align-items:center; }
  .nav-btn{
    background: transparent;
    border:1px solid rgba(255,255,255,0.04);
    color:var(--muted);
    padding:10px 14px;
    border-radius:12px;
    cursor:pointer;
    font-weight:600;
    transition: all .16s ease;
    backdrop-filter: blur(var(--card-blur));
  }
  .nav-btn:hover{ transform: translateY(-4px); color:var(--white); box-shadow: 0 12px 40px rgba(60,40,120,0.14) }
  .nav-btn.active{
    background: linear-gradient(90deg, rgba(255,154,92,0.65), rgba(255,199,255,0.06));
    color:var(--white);
    box-shadow: 0 12px 40px rgba(74,60,140,0.12);
    transform: translateY(-2px);
    border:1px solid rgba(248,251,255,0.67);
  }

  /* HOME - about box (3D glass) */
  .home-card{
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.015));
    padding:24px;
    border-radius:16px;
    box-shadow: 0 20px 50px rgba(6,8,20,0.6), inset 0 1px 0 rgba(255,255,255,0.02);
    border:1px solid rgba(248,25,255,0.04);
    margin-bottom:18px;
    position:relative;
    overflow:visible;
    transform-style: preserve-3d;
  }
  .about-3d {
    perspective: 1200px;
  }
  .about-card {
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border-radius:14px;
    padding:20px;
    transform: translateZ(0) rotateX(0.6deg);
    box-shadow: 0 18px 50px rgba(2,6,23,0.7), 0 6px 20px rgba(124,92,255,0.06);
    border:1px solid rgba(124,92,255,0.06);
    transition: transform .36s cubic-bezier(.2,.85,.2,1), box-shadow .36s ease;
    backdrop-filter: blur(14px) saturate(120%);
    -webkit-backdrop-filter: blur(14px) saturate(120%);
  }
  .about-card:hover{ transform: translateY(-6px) rotateX(1deg); box-shadow: 0 28px 80px rgba(2,6,23,0.75) }

  .about-card h2{ margin:0 0 10px 0; color:var(--accent-1); font-size:1.35rem }
  .about-card p{ margin:0; color:var(--muted); line-height:1.75; font-size:0.98rem; text-align:justify }

  /* scroll arrow */
  .scroll-down {
    display:flex; align-items:center; justify-content:center;
    width:56px; height:56px; border-radius:28px;
    margin:18px auto 6px; cursor:pointer;
    background: linear-gradient(180deg, rgba(124,92,255,0.12), rgba(58,199,255,0.06));
    border:1px solid rgba(124,92,255,0.12);
    box-shadow: 0 12px 30px rgba(58,40,120,0.12);
    animation: floaty 2.2s ease-in-out infinite;
  }
  @keyframes floaty { 0%{ transform: translateY(0)} 50%{ transform: translateY(-8px)} 100%{ transform: translateY(0)} }
  .scroll-down svg{ filter: drop-shadow(0 6px 12px rgba(30,20,80,0.45)); }

  /* three info cards container */
  .info-row{ display:flex; gap:14px; margin-top:18px; flex-wrap:wrap; justify-content:center }
  .info-card{
    flex:1 1 28%;
    min-width:240px;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border-radius:12px;
    padding:16px;
    box-shadow: 0 14px 40px rgba(3,6,14,0.6);
    border:1px solid rgba(255,255,255,0.03);
    transform: translateY(18px);
    opacity:0;
    transition: transform .42s cubic-bezier(.2,.9,.2,1), opacity .42s ease;
  }
  .info-card.show { transform: translateY(0); opacity:1; }
  .info-card h4{ margin:0 0 8px 0; color:var(--accent-2) }
  .info-card p{ margin:0; color:var(--muted); font-size:0.95rem; line-height:1.5 }

  /* CTA & controls */
  .cta{ display:flex; gap:12px; margin-top:18px; flex-wrap:wrap; justify-content:center; }
  .primary-btn{
    background: linear-gradient(90deg,var(--accent-1), var(--accent-2));
    color:white;border:none;padding:12px 18px;border-radius:12px;cursor:pointer;font-weight:800;
    box-shadow: 0 14px 40px rgba(72,56,160,0.16);
    transition: transform .12s cubic-bezier(.2,.9,.2,1), box-shadow .12s;
  }
  .primary-btn:hover{ transform: translateY(-4px) scale(1.02) }

  .secondary-btn{
    background: transparent;
    border: 1px solid rgba(92,242,255,0.47);
    padding:10px 14px; border-radius:12px; cursor:pointer; font-weight:700;
    color: rgb(230,230,230);
  }

  /* Play card & board */
  .card{
    background: linear-gradient(180deg, rgba(12,14,24,0.7), rgba(6,8,20,0.6));
    border-radius:14px; padding:18px; margin-top:18px; box-shadow: 0 20px 60px rgba(2,6,23,0.7);
    border:1px solid rgba(255,255,255,0.02);
  }
  .controls{ display:flex; gap:8px; align-items:center; flex-wrap:wrap; justify-content:center; margin-bottom:14px; }
  .controls label{ font-weight:600; color:var(--muted); margin-left:6px; }
  input[type=number]{ width:110px; padding:10px; border-radius:10px; border:1px solid rgba(94,242,255,0.47); text-align:center; font-weight:600; background:transparent; color:rgb(230,230,230) }
  select{ padding:10px; border-radius:10px; border:1px solid rgba(94,242,255,0.47); font-weight:600; background:transparent; color:rgba(76,166,190,0.87) }

  #boardContainer{ display:flex; flex-direction:column; align-items:center; gap:12px; margin-top:8px; }
  #board{ display:grid; border-radius:10px; overflow:hidden; background:transparent; transition: all .25s ease; }
  .cell{
    width:56px; height:56px; display:flex; align-items:center; justify-content:center; font-size:32px; user-select:none;
    cursor:pointer; transition: all .12s ease, transform .12s ease, box-shadow .12s;
  }
  .cell:hover{ transform: translateY(-6px); box-shadow: 0 20px 40px rgba(0,0,0,0.6) }
  /* ensure clear black & white squares that pop */
  .white{
    background: linear-gradient(180deg,#ffffff,#f1f5ff);
    color:var(--black);
    box-shadow: inset 0 -6px 14px rgba(0,0,0,0.03), 0 6px 20px rgba(70,60,120,0.04);
  }
  .black{
    background: linear-gradient(180deg,#0b0b0b,#151521);
    color:var(--white);
    box-shadow: 0 8px 30px rgba(0,0,0,0.7);
  }
  .queen{ color:#ffdd57; text-shadow:0 6px 20px rgba(255,170,70,0.12); font-size:28px }
  .invalid{ background: rgba(255,80,80,0.14) !important; color: #ffb4b4 !important; }

  #resultMessage{ margin-top:8px; font-weight:800; display:none; color:var(--success); }

  /* Learn cards */
  .learn-grid{ display:flex; gap:12px; justify-content:center; flex-wrap:wrap; margin-top:10px }
  .video-card{ width:320px; background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); padding:14px; border-radius:12px; text-align:left; border:1px solid rgba(255,255,255,0.02) }
  .video-card h4{ margin:0 0 6px 0; color:var(--accent-2) }
  .video-card p{ color:var(--muted); margin:0 0 8px 0 }

  /* modal */
  .modal{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(2,6,23,0.8); z-index:999; }
  .modal .modal-body{ width:92%; max-width:900px; background:linear-gradient(180deg,#0e1220,#07070b); padding:12px; border-radius:10px; box-shadow:0 30px 80px rgba(2,6,23,0.9); border:1px solid rgba(124,92,255,0.06) }

  footer{ margin-top:20px; color:var(--muted); font-size:0.95rem; text-align:center; padding-bottom:36px }

  /* confetti canvas */
  #confettiCanvas{ position:fixed; inset:0; pointer-events:none; z-index:1200; display:none; }

  /* small screens */
  @media(max-width:880px){
    .info-row{ flex-direction:column; }
    .cell{ width:44px; height:44px; font-size:26px }
    header{ flex-direction:column; align-items:flex-start; gap:8px }
  }

  /* page show transitions */
  .page { opacity:0; transform: translateY(6px); transition: opacity .28s ease, transform .28s ease; }
  .page.show { opacity:1; transform: translateY(0); }
</style>
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">
        <div class="logo">â™›</div>
        <div>
          <h1>N-Queen AI Solver</h1>
          <p class="sub">Deepa & Ishika â€” AI & DS (YCCE)</p>
        </div>
      </div>

      <nav>
        <button id="navHome" class="nav-btn active" onclick="show('home')">Home</button>
        <button id="navPlay" class="nav-btn" onclick="show('play')">Play</button>
        <button id="navLearn" class="nav-btn" onclick="show('learn')">Learn</button>
      </nav>
    </header>

    <!-- HOME -->
    <section id="home" class="page show">
      <div class="home-card about-3d">
        <div class="about-card">
          <h2>About this Project</h2>
          <p>
            This project is a part of our journey in exploring the fascinating world of Artificial Intelligence. It demonstrates the implementation of intelligent problem-solving techniques through the N-Queens Puzzle, a classic AI problem. The system incorporates multiple AI algorithms such as Backtracking, Hill Climbing, and Genetic Algorithm to find valid solutions for placing N queens on a chessboard so that no two queens attack each other.
            <br><br>
            This project has been designed and developed by Deepa and Ishika, students of the 5th semester, Artificial Intelligence and Data Science (AIDS) branch at Yeshwantrao Chavan College of Engineering, Nagpur (YCCE).
            <br><br>
            The objective of this project is not only to provide a hands-on experience in AI algorithm implementation but also to encourage intuitive understanding through interactive visualization and educational content.
          </p>
        </div>

        <!-- scroll arrow that reveals info cards -->
        <div class="scroll-down" title="Scroll to info" onclick="revealInfo()">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M12 5v14M5 12l7 7 7-7" stroke="white" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>

        <!-- three info cards (hidden then reveal on scroll click) -->
        <div id="infoSection" style="margin-top:8px; opacity:0; transform: translateY(8px); transition: all .5s ease;">
          <div class="info-row">
            <div class="info-card" id="card1">
              <h4>What is N-Queen?</h4>
              <p>The N-Queens problem asks how to place N chess queens on an NÃ—N board so that none can attack another â€” i.e., no two share a row, column, or diagonal.</p>
            </div>

            <div class="info-card" id="card2">
              <h4>Its Importance</h4>
              <p>N-Queens is a classic constraint-satisfaction and combinatorial optimization problem used in teaching search algorithms, heuristics, and metaheuristics in AI courses.</p>
            </div>

            <div class="info-card" id="card3">
              <h4>Applications in AI</h4>
              <p>The N-Queens problem helps teach algorithm design, constraint solving, optimization techniques, and provides a practical case to compare exact and heuristic methods used widely in AI and operations research.</p>
            </div>
          </div>
        </div>

        <div class="cta" style="margin-top:18px">
          <button class="primary-btn" onclick="show('play')">â–¶ Play N-Queen</button>
          <button class="secondary-btn" onclick="show('learn')">ðŸ§  Learn Algorithms</button>
        </div>
      </div>
    </section>

    <!-- PLAY page -->
    <section id="play" class="page" style="display:none">
      <div class="card" style="display:flex;flex-direction:column;align-items:center">
        <div class="controls">
          <label>Board size (N):</label>
          <input id="nInput" type="number" min="1" max="20" value="8" />
          <button class="secondary-btn" onclick="loadBoard()">Load Board</button>

          <label style="margin-left:6px">Algorithm:</label>
          <select id="algoSelect">
            <option value="backtracking">Backtracking</option>
            <option value="hillclimbing">Hill Climbing</option>
            <option value="genetic">Genetic</option>
          </select>

          <button class="primary-btn" onclick="autoSolve()">Solve</button>
          <button class="secondary-btn" onclick="resetBoard()">Reset</button>
        </div>

        <div id="boardContainer">
          <div id="board"></div>
          <div id="resultMessage"></div>
        </div>
      </div>
    </section>

    <!-- LEARN -->
    <section id="learn" class="page" style="display:none">
      <div class="card">
        <h3 style="color:var(--accent-2); margin:0 0 8px 0">Learn â€” curated lectures</h3>
        <p style="color:var(--muted); margin:0 0 12px 0">Click "Watch Video" to open an embedded player.</p>

        <div class="learn-grid">
          <div class="video-card">
            <h4>Backtracking â€” N-Queens (lecture)</h4>
            <p>Classic backtracking approach explanation.</p>
            <div style="display:flex;gap:8px;align-items:center">
              <button class="secondary-btn" onclick="openVideo('backtracking')">â–¶ Watch Video</button>
              <a href="https://www.youtube.com/watch?v=xFv_Hl4B83A" target="_blank" style="color:var(--accent-2); margin-left:8px">YouTube</a>
            </div>
          </div>

          <div class="video-card">
            <h4>Hill Climbing / Local Search</h4>
            <p>Local search and hill-climbing strategies for N-Queens.</p>
            <div style="display:flex;gap:8px;align-items:center">
              <button class="secondary-btn" onclick="openVideo('hill')">â–¶ Watch Video</button>
              <a href="https://www.youtube.com/watch?v=tCaYz8fmlpE" target="_blank" style="color:var(--accent-2); margin-left:8px">YouTube</a>
            </div>
          </div>

          <div class="video-card">
            <h4>Genetic Algorithms</h4>
            <p>Population-based optimization and GA concepts.</p>
            <div style="display:flex;gap:8px;align-items:center">
              <button class="secondary-btn" onclick="openVideo('genetic')">â–¶ Watch Video</button>
              <a href="https://www.youtube.com/watch?v=tTFBz6tbUfU" target="_blank" style="color:var(--accent-2); margin-left:8px">YouTube</a>
            </div>
          </div>
        </div>
      </div>
    </section>

    <footer>Â© 2025 â€” N-Queen AI Project</footer>
  </div>

  <!-- video modal -->
  <div id="videoModal" class="modal" onclick="closeVideo()">
    <div class="modal-body" onclick="event.stopPropagation()">
      <div style="display:flex;justify-content:flex-end"><button class="nav-btn" onclick="closeVideo()">Close</button></div>
      <div id="videoHolder" style="margin-top:8px"></div>
    </div>
  </div>

  <!-- confetti canvas -->
  <canvas id="confettiCanvas"></canvas>

<script>
/* --- Page navigation with fade and active nav styling --- */
function show(id){
  document.querySelectorAll('.page').forEach(p=>{
    p.classList.remove('show');
    p.style.display = 'none';
  });
  const el = document.getElementById(id);
  el.style.display = 'block';
  requestAnimationFrame(()=> setTimeout(()=> el.classList.add('show'), 12) );

  // nav active
  document.querySelectorAll('nav .nav-btn').forEach(b=>b.classList.remove('active'));
  if(id==='home') document.getElementById('navHome').classList.add('active');
  if(id==='play') document.getElementById('navPlay').classList.add('active');
  if(id==='learn') document.getElementById('navLearn').classList.add('active');

  if(id==='play') loadBoard();
  window.scrollTo({top:0, behavior:'smooth'});
}

/* --- Board logic (kept but adjusted visuals) --- */
let N=8, board=[], userPlaced=[];
const boardEl = ()=>document.getElementById('board');
const msgEl = ()=>document.getElementById('resultMessage');

/* sound: simple click and success using WebAudio (only clicks & success) */
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
function playClick(){
  const o = audioCtx.createOscillator();
  const g = audioCtx.createGain();
  o.type='sine'; o.frequency.setValueAtTime(720, audioCtx.currentTime);
  g.gain.setValueAtTime(0.0001, audioCtx.currentTime);
  g.gain.exponentialRampToValueAtTime(0.06, audioCtx.currentTime+0.01);
  g.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime+0.25);
  o.connect(g); g.connect(audioCtx.destination);
  o.start(); o.stop(audioCtx.currentTime+0.26);
}
function playSuccess(){
  const now = audioCtx.currentTime;
  const g = audioCtx.createGain(); g.connect(audioCtx.destination);
  g.gain.setValueAtTime(0.0001, now);
  g.gain.linearRampToValueAtTime(0.09, now+0.02);
  g.gain.exponentialRampToValueAtTime(0.0001, now+1.2);
  const osc1 = audioCtx.createOscillator(); osc1.type='triangle'; osc1.frequency.setValueAtTime(440, now);
  const osc2 = audioCtx.createOscillator(); osc2.type='sine'; osc2.frequency.setValueAtTime(660, now);
  osc1.connect(g); osc2.connect(g);
  osc1.start(now); osc2.start(now+0.02);
  osc1.frequency.exponentialRampToValueAtTime(880, now+0.35);
  osc2.frequency.exponentialRampToValueAtTime(990, now+0.45);
  osc1.stop(now+1.1); osc2.stop(now+1.1);
}

/* confetti engine (keeps visual celebration) */
const confetti = (function(){
  const canvas = document.getElementById('confettiCanvas');
  const ctx = canvas.getContext('2d');
  let W=0,H=0, particles=[], running=false, rafId=null;
  function resize(){ W=canvas.width = innerWidth; H=canvas.height = innerHeight; }
  function rand(min,max){ return Math.random()*(max-min)+min; }
  function spawn(n=80){
    particles = [];
    for(let i=0;i<n;i++){
      particles.push({
        x: rand(0,W),
        y: rand(-H*0.2,0),
        vx: rand(-2,2),
        vy: rand(2,6),
        size: Math.floor(rand(6,12)),
        color: `hsl(${Math.floor(rand(200,300))}deg, 80%, ${Math.floor(rand(45,65))}%)`,
        rot: rand(0,Math.PI*2),
        drot: rand(-0.12,0.12),
        lifetime: rand(2200,4000),
        born: performance.now()
      });
    }
    if(!running){ running=true; canvas.style.display = 'block'; resize(); loop(); }
  }
  function loop(now){
    ctx.clearRect(0,0,W,H);
    const t = now || performance.now();
    particles.forEach(p=>{
      p.x += p.vx; p.y += p.vy; p.rot += p.drot;
      ctx.save();
      ctx.translate(p.x,p.y);
      ctx.rotate(p.rot);
      ctx.fillStyle = p.color;
      ctx.fillRect(-p.size/2, -p.size/2, p.size, p.size*0.7);
      ctx.restore();
    });
    particles = particles.filter(p => (t - p.born) < p.lifetime && p.y < H+50);
    if(particles.length>0) rafId = requestAnimationFrame(loop);
    else { running=false; canvas.style.display='none'; cancelAnimationFrame(rafId); }
  }
  window.addEventListener('resize', ()=>{ if(running) resize() });
  return { burst: spawn };
})();

/* load board */
function loadBoard(){
  const input = parseInt(document.getElementById('nInput').value) || 8;
  if(input===2 || input===3){
    showMessageFail('âŒ N = 2 and N = 3 are not allowed (no solution exists)');
    return;
  }
  N = input;
  const b = boardEl();
  b.innerHTML = '';
  // compute cell size so the board fits nicely
  const maxWidth = Math.min(520, window.innerWidth - 120);
  const cellSize = Math.max(36, Math.min(64, Math.floor(maxWidth / N) ));
  b.style.gridTemplateColumns = `repeat(${N}, ${cellSize}px)`;
  board = Array.from({length:N}, ()=>Array(N).fill(0));
  userPlaced = Array.from({length:N}, ()=>Array(N).fill(false));
  for(let r=0;r<N;r++){
    for(let c=0;c<N;c++){
      const cell = document.createElement('div');
      cell.className = 'cell ' + (((r+c)%2===0)?'white':'black');
      cell.dataset.r = r; cell.dataset.c = c;
      cell.style.transitionDelay = `${(r+c)*6}ms`;
      cell.addEventListener('click', onCellClick);
      b.appendChild(cell);
    }
  }
  hideMessage();
}

/* user place/remove */
function onCellClick(e){
  if(audioCtx.state === 'suspended') audioCtx.resume();
  playClick();
  const r = parseInt(e.currentTarget.dataset.r);
  const c = parseInt(e.currentTarget.dataset.c);
  if(board[r][c]===1){
    board[r][c]=0; userPlaced[r][c]=false;
  } else {
    board[r][c]=1; userPlaced[r][c]=true;
    e.currentTarget.animate([{ transform:'scale(.94)' }, { transform:'scale(1.06)' }, { transform:'scale(1)' }], { duration:220, easing:'cubic-bezier(.2,.9,.2,1)' });
  }
  refreshUI(); checkUserSolved();
}

/* refresh UI and highlight user conflicts */
function refreshUI(){
  const cells = boardEl().children;
  for(let r=0;r<N;r++) for(let c=0;c<N;c++){
    const idx = r*N + c;
    const cell = cells[idx];
    cell.textContent = board[r][c] ? 'â™›' : '';
    cell.classList.toggle('queen', board[r][c]===1);
    cell.classList.remove('invalid');
  }
  for(let r=0;r<N;r++) for(let c=0;c<N;c++){
    if(userPlaced[r][c] && board[r][c]===1 && isConflicting(r,c)){
      boardEl().children[r*N+c].classList.add('invalid');
    }
  }
}

/* conflict detection */
function isConflicting(r,c){
  for(let i=0;i<N;i++){
    if(i!==c && board[r][i]===1) return true;
    if(i!==r && board[i][c]===1) return true;
  }
  for(let d=-N; d<=N; d++){
    if(d===0) continue;
    let rr=r+d, cc=c+d;
    if(rr>=0 && rr<N && cc>=0 && cc<N && board[rr][cc]===1) return true;
    rr=r+d; cc=c-d;
    if(rr>=0 && rr<N && cc>=0 && cc<N && board[rr][cc]===1) return true;
  }
  return false;
}

/* user solved check */
function checkUserSolved(){
  let count=0, conflict=false;
  for(let r=0;r<N;r++) for(let c=0;c<N;c++){
    if(board[r][c]===1 && userPlaced[r][c]) { count++; if(isConflicting(r,c)) conflict=true; }
  }
  if(count===N && !conflict){
    showMessageSuccess('ðŸŽ‰ Congrats! You solved it!');
    playSuccess();
    confetti.burst(100);
  } else {
    const m = msgEl();
    if(!m.textContent.includes('not allowed')) hideMessage();
  }
}

/* messages */
function hideMessage(){ const m=msgEl(); m.style.display='none'; m.textContent=''; m.style.color=''; }
function showMessageSuccess(t){ const m=msgEl(); m.style.display='block'; m.textContent=t; m.style.color='var(--success)'; }
function showMessageFail(t){ const m=msgEl(); m.style.display='block'; m.textContent=t; m.style.color='var(--danger)'; }

/* reset */
function resetBoard(){ loadBoard(); }

/* solver dispatcher */
async function autoSolve(){
  hideMessage();
  const algo = document.getElementById('algoSelect').value;
  const input = parseInt(document.getElementById('nInput').value) || N;
  if(input===2 || input===3){ showMessageFail('âŒ N = 2 and N = 3 are not allowed'); return; }
  if(input !== N) loadBoard();
  for(let r=0;r<N;r++) for(let c=0;c<N;c++) if(userPlaced[r][c]) if(isConflictingWithUser(r,c)){ showMessageFail('âŒ Conflicting fixed queens â€” solver aborted'); return; }

  if(algo==='backtracking') return backtrackingSolve();
  if(algo==='hillclimbing') return hillClimbSolve();
  if(algo==='genetic') return geneticSolve();
}

/* -------- Backtracking (visual) -------- */
async function backtrackingSolve(){
  const work = Array.from({length:N}, ()=>Array(N).fill(0));
  for(let r=0;r<N;r++) for(let c=0;c<N;c++) if(userPlaced[r][c]) work[r][c]=1;

  function safe(row,col){
    for(let i=0;i<N;i++) if(work[row][i]===1 && i!==col) return false;
    for(let i=0;i<N;i++) if(work[i][col]===1 && i!==row) return false;
    for(let d=-N; d<=N; d++){
      if(d===0) continue;
      let rr=row+d, cc=col+d;
      if(rr>=0&&rr<N&&cc>=0&&cc<N && work[rr][cc]===1) return false;
      rr=row+d; cc=col-d;
      if(rr>=0&&rr<N&&cc>=0&&cc<N && work[rr][cc]===1) return false;
    }
    return true;
  }

  async function placeRow(row){
    if(row===N){
      for(let r=0;r<N;r++) for(let c=0;c<N;c++) board[r][c]=work[r][c];
      refreshUI(); return true;
    }
    for(let c=0;c<N;c++) if(userPlaced[row][c]) { if(!safe(row,c)) return false; if(await placeRow(row+1)) return true; return false; }
    for(let col=0; col<N; col++){
      if(safe(row,col)){
        work[row][col]=1; applyWork(work); await sleep(45);
        if(await placeRow(row+1)) return true;
        work[row][col]=0; applyWork(work); await sleep(20);
      }
    }
    return false;
  }

  const solved = await placeRow(0);
  if(solved){ showMessageSuccess('âœ… Solution Found using Backtracking!'); playSuccess(); confetti.burst(90); }
  else showMessageFail('âŒ Solution Not Found â€” Algorithm insufficient!');
}

/* helper: check user conflict among fixed queens */
function isConflictingWithUser(r,c){
  for(let i=0;i<N;i++){
    if(i!==c && userPlaced[r][i] && board[r][i]===1) return true;
    if(i!==r && userPlaced[i][c] && board[i][c]===1) return true;
  }
  for(let d=-N; d<=N; d++){
    if(d===0) continue;
    let rr = r + d, cc = c + d;
    if(rr>=0&&rr<N&&cc>=0&&cc<N && userPlaced[rr][cc] && board[rr][cc]===1) return true;
    rr = r + d; cc = c - d;
    if(rr>=0&&rr<N&&cc>=0&&cc<N && userPlaced[rr][cc] && board[rr][cc]===1) return true;
  }
  return false;
}

/* apply work to main board */
function applyWork(work){
  for(let r=0;r<N;r++) for(let c=0;c<N;c++) board[r][c]=work[r][c];
  refreshUI();
}

/* -------- Hill Climbing (visual) -------- */
async function hillClimbSolve(){
  function buildInitial(){
    const q = new Array(N);
    for(let col=0; col<N; col++){
      let fixedRow=-1;
      for(let r=0;r<N;r++) if(userPlaced[r][col]) fixedRow=r;
      q[col] = (fixedRow>=0? fixedRow : Math.floor(Math.random()*N));
    }
    return q;
  }
  function conflicts(q){
    let cnt=0;
    for(let i=0;i<N;i++) for(let j=i+1;j<N;j++){
      if(q[i]===q[j] || Math.abs(q[i]-q[j])===Math.abs(i-j)) cnt++;
    }
    return cnt;
  }
  let q = buildInitial();
  let c = conflicts(q);
  for(let iter=0; iter<2000 && c>0; iter++){
    let improved=false;
    for(let col=0; col<N; col++){
      let fixed=false; for(let r=0;r<N;r++) if(userPlaced[r][col]) fixed=true;
      if(fixed) continue;
      let bestRow=q[col], bestC=c;
      for(let row=0; row<N; row++){
        let tmp=q.slice(); tmp[col]=row;
        let newC=conflicts(tmp);
        if(newC<bestC){ bestC=newC; bestRow=row; }
      }
      if(bestRow!==q[col]){ q[col]=bestRow; c=bestC; improved=true; }
    }
    applyQueens(q); await sleep(55);
    if(!improved){
      for(let col=0; col<N; col++){
        let fixed=false; for(let r=0;r<N;r++) if(userPlaced[r][col]) fixed=true;
        if(!fixed) q[col] = Math.floor(Math.random()*N);
      }
      c = conflicts(q);
    }
  }

  if(c===0){ showMessageSuccess('âœ… Solution Found using Hill Climbing!'); playSuccess(); confetti.burst(90); return true; }
  else { showMessageFail('âŒ Hill Climbing could not find a solution'); return false; }
}

/* -------- Genetic Algorithm (visual) -------- */
async function geneticSolve(){
  function fitness(q){
    let count=0;
    for(let i=0;i<N;i++) for(let j=i+1;j<N;j++){
      if(q[i]!==q[j] && Math.abs(q[i]-q[j])!==Math.abs(i-j)) count++;
    }
    return count;
  }
  function randomQ(){
    const q = new Array(N);
    for(let i=0;i<N;i++){
      let fixedRow=-1;
      for(let r=0;r<N;r++) if(userPlaced[r][i]) fixedRow=r;
      q[i] = (fixedRow>=0 ? fixedRow : Math.floor(Math.random()*N));
    }
    return q;
  }

  let population = Array.from({length:60}, ()=>randomQ());
  const target = N*(N-1)/2;
  for(let gen=0; gen<1000; gen++){
    population.sort((a,b)=>fitness(b)-fitness(a));
    const best = population[0];
    applyQueens(best); await sleep(45);
    if(fitness(best)===target){ showMessageSuccess('âœ… Genetic Algorithm Solved!'); playSuccess(); confetti.burst(100); return true; }

    const parents = population.slice(0,20);
    const newPop = [];
    while(newPop.length < population.length){
      const p1 = parents[Math.floor(Math.random()*parents.length)];
      const p2 = parents[Math.floor(Math.random()*parents.length)];
      const cross = Math.floor(Math.random()*N);
      const child = p1.slice(0,cross).concat(p2.slice(cross));
      if(Math.random()<0.12){
        let col = Math.floor(Math.random()*N);
        let fixed=false; for(let r=0;r<N;r++) if(userPlaced[r][col]) fixed=true;
        if(!fixed) child[col] = Math.floor(Math.random()*N);
      }
      for(let col=0; col<N; col++){
        for(let row=0; row<N; row++) if(userPlaced[row][col]) child[col]=row;
      }
      newPop.push(child);
    }
    population = newPop;
  }
  showMessageFail('âŒ Genetic Algorithm could not find a solution');
  return false;
}

/* apply q array to board */
function applyQueens(q){
  board = Array.from({length:N}, ()=>Array(N).fill(0));
  for(let c=0;c<N;c++) board[q[c]][c]=1;
  refreshUI();
}

/* helpers */
function sleep(ms){ return new Promise(res=>setTimeout(res,ms)); }

/* Video modal logic */
const videos = {
  backtracking: "https://www.youtube.com/embed/xFv_Hl4B83A",
  hill: "https://www.youtube.com/embed/tCaYz8fmlpE",
  genetic: "https://www.youtube.com/embed/tTFBz6tbUfU"
};
function openVideo(key){
  const modal = document.getElementById('videoModal');
  const holder = document.getElementById('videoHolder');
  holder.innerHTML = `<iframe width="100%" height="480" src="${videos[key]}?rel=0" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>`;
  modal.style.display='flex';
}
function closeVideo(){
  const modal = document.getElementById('videoModal');
  const holder = document.getElementById('videoHolder');
  holder.innerHTML='';
  modal.style.display='none';
}

/* reveal info cards (animated) */
function revealInfo(){
  const sec = document.getElementById('infoSection');
  sec.style.opacity = 1;
  sec.style.transform = 'translateY(0)';
  // stagger show of cards
  setTimeout(()=> document.getElementById('card1').classList.add('show'), 120);
  setTimeout(()=> document.getElementById('card2').classList.add('show'), 260);
  setTimeout(()=> document.getElementById('card3').classList.add('show'), 420);
  // smooth scroll to the section
  sec.scrollIntoView({behavior:'smooth', block:'center'});
}

/* init */
window.addEventListener('load', ()=>{ loadBoard(); });

</script>
</body>
</html>
